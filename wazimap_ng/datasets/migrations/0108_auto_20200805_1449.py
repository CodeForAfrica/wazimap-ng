# Generated by Django 2.2.10 on 2020-08-05 14:49

from django.db import migrations


def collection_group_perms(apps, schema_editor):

    Group = apps.get_model("auth", "Group")
    Permission = apps.get_model("auth", "Permission")

    # get groups
    data_admin = Group.objects.get(name="DataAdmin")
    profile_admin = Group.objects.get(name="ProfileAdmin")

    # get collection permissions
    permissions = Permission.objects.filter(
        content_type__app_label="points", content_type__model="category"
    ).values_list("id", flat=True)

    # Add collection permission to DataAdmin group
    data_admin.permissions.add(*permissions)

    # Remove collection perms from ProfileAdmin group
    profile_admin.permissions.remove(*permissions)


class Migration(migrations.Migration):

    dependencies = [
        ('datasets', '0107_auto_20200717_1053'),
    ]

    operations = [
        migrations.RunPython(collection_group_perms),
    ]
